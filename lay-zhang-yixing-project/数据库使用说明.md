# LAY张艺兴音乐网站 - MySQL数据库使用说明

## 数据库配置

本项目现在使用 **MySQL 数据库** 作为后端存储，替代了之前的H2内存数据库。

### 连接信息
- **数据库类型**: MySQL 8.0+
- **数据库名称**: `lay_music`
- **主机地址**: `localhost`
- **端口**: `3306`
- **用户名**: `root`
- **密码**: `Hansen1791428864`

### 数据库准备

#### 1. 确保MySQL服务运行
```bash
# Windows服务管理
services.msc
# 或命令行启动
net start mysql80
```

#### 2. 创建数据库
```sql
CREATE DATABASE lay_music 
CHARACTER SET utf8mb4 
COLLATE utf8mb4_unicode_ci;
```

#### 3. 验证连接
```sql
USE lay_music;
SHOW TABLES;
```

## 数据表结构

### Users表 (用户表)
应用启动时会自动创建以下表结构：

```sql
CREATE TABLE `users` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `username` varchar(50) NOT NULL,
  `password` varchar(255) NOT NULL,
  `email` varchar(100) NOT NULL,
  `real_name` varchar(100) DEFAULT NULL,
  `phone` varchar(20) DEFAULT NULL,
  `avatar` varchar(255) DEFAULT NULL,
  `status` varchar(20) DEFAULT 'ACTIVE',
  `created_time` datetime(6) DEFAULT NULL,
  `updated_time` datetime(6) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `UK_username` (`username`),
  UNIQUE KEY `UK_email` (`email`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

## 默认管理员账号

系统启动时会自动创建默认管理员账号：
- **用户名**: `admin`
- **密码**: `LayMusic@2025`
- **角色**: 系统管理员

## API接口

### 用户管理接口
- `GET /api/admin/users` - 获取用户列表
- `POST /api/admin/users` - 创建新用户
- `PUT /api/admin/users/{id}` - 更新用户信息
- `DELETE /api/admin/users/{id}` - 删除用户

### 认证接口
- `POST /api/admin/login` - 管理员登录
- `POST /api/admin/logout` - 管理员登出
- `GET /api/admin/verify` - 验证token

## 数据持久化

✅ **MySQL数据库特点：**
- 数据永久保存到磁盘
- 支持事务操作
- 支持复杂查询
- 支持数据备份恢复
- 高并发支持

## 启动步骤

1. **确保MySQL服务运行**
2. **创建数据库** `lay_music`
3. **启动后端应用**:
   ```bash
   cd backend
   java -jar target/music-admin-1.0.0.jar
   ```
4. **启动前端应用**:
   ```bash
   npm run dev
   ```

## 访问地址

- **前端界面**: http://localhost:3005/
- **后台登录**: http://localhost:3005/admin/login
- **后端API**: http://localhost:8080/api/
- **跳转入口**: http://localhost:8080/x-back

## 数据库管理

可以使用以下工具管理MySQL数据库：
- **Navicat Premium**
- **MySQL Workbench**
- **phpMyAdmin**
- **命令行客户端**

## 备份与恢复

### 备份数据库
```bash
mysqldump -u root -p lay_music > lay_music_backup.sql
```

### 恢复数据库  
```bash
mysql -u root -p lay_music < lay_music_backup.sql
```

## 故障排除

### 连接问题
1. 检查MySQL服务是否运行
2. 验证数据库连接信息
3. 检查防火墙设置
4. 确认数据库用户权限

### 编码问题
确保数据库使用UTF-8编码：
```sql
ALTER DATABASE lay_music 
CHARACTER SET utf8mb4 
COLLATE utf8mb4_unicode_ci;
```

---

**重要提示**: 确保在生产环境中修改默认密码，并配置适当的数据库安全设置。 
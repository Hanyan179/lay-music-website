# Lay Zhang 音乐后台管理系统

## 项目概述

本项目为 Lay Zhang 音乐网站的后台管理系统，提供音乐作品的维护管理功能。系统采用前后端分离架构，前端使用 Vue.js 3，后端使用 Java Spring Boot 框架。

## 技术栈

### 前端技术栈
- **Vue.js 3** - 前端框架
- **Vue Router** - 路由管理
- **JavaScript ES6+** - 编程语言
- **CSS3** - 样式设计
- **Fetch API** - HTTP 请求

### 后端技术栈
- **Java 8+** - 编程语言
- **Spring Boot** - Web 框架
- **Spring Data JPA** - 数据访问层
- **MySQL** - 数据库
- **Maven** - 项目构建工具

## 系统架构

```
前端 (Vue.js)
    ↓ HTTP API
后端 (Spring Boot)
    ↓ JPA/JDBC
数据库 (MySQL)
```

## 数据库设计

### 1. 管理员用户表 (admin_users)

```sql
CREATE TABLE `admin_users` (
  `id` varchar(255) NOT NULL COMMENT '加密ID',
  `username` varchar(50) NOT NULL COMMENT '用户名',
  `password` varchar(255) NOT NULL COMMENT '加密密码',
  `salt` varchar(100) NOT NULL COMMENT '密码盐值',
  `real_name` varchar(100) COMMENT '真实姓名',
  `email` varchar(255) COMMENT '加密邮箱',
  `phone` varchar(255) COMMENT '加密手机号',
  `status` tinyint(1) DEFAULT 1 COMMENT '用户状态(0:禁用,1:启用)',
  `last_login_time` datetime COMMENT '最后登录时间',
  `last_login_ip` varchar(255) COMMENT '加密最后登录IP',
  `login_fail_count` int DEFAULT 0 COMMENT '登录失败次数',
  `lock_time` datetime COMMENT '账号锁定时间',
  `department` varchar(100) COMMENT '部门团队',
  `position` varchar(100) COMMENT '职位',
  `preferences` json COMMENT '用户偏好设置',
  `roles` json COMMENT '权限角色',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP,
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `creator_id` varchar(255) COMMENT '创建者ID',
  `updater_id` varchar(255) COMMENT '更新者ID',
  `deleted` tinyint(1) DEFAULT 0 COMMENT '逻辑删除标志',
  `version` int DEFAULT 0 COMMENT '版本号',
  PRIMARY KEY (`id`),
  UNIQUE KEY `username` (`username`)
);
```

### 2. 专辑表 (albums)

```sql
CREATE TABLE `albums` (
  `id` varchar(255) NOT NULL COMMENT '加密ID',
  `album_title` varchar(200) NOT NULL COMMENT '专辑名称',
  `track_count` int DEFAULT 0 COMMENT '歌曲数量',
  `total_duration` varchar(20) COMMENT '总时长',
  `genre` varchar(100) COMMENT '歌曲类型',
  `release_year` int NOT NULL COMMENT '发行年份',
  `description` text COMMENT '专辑描述',
  `achievements` json COMMENT '成就列表',
  `netease_album_id` varchar(100) COMMENT '网易云专辑ID',
  `background_image` varchar(500) COMMENT '背景图片地址',
  `cover_image` varchar(500) COMMENT '专辑封面地址',
  `play_stats` json COMMENT '播放统计数据',
  `status` tinyint(1) DEFAULT 1 COMMENT '专辑状态',
  `sort_order` int DEFAULT 0 COMMENT '排序权重',
  `is_featured` tinyint(1) DEFAULT 0 COMMENT '是否置顶',
  `record_label` varchar(200) COMMENT '发行公司',
  `producer` varchar(200) COMMENT '制作人',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP,
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `creator_id` varchar(255) COMMENT '创建者ID',
  `updater_id` varchar(255) COMMENT '更新者ID',
  `deleted` tinyint(1) DEFAULT 0 COMMENT '逻辑删除标志',
  `version` int DEFAULT 0 COMMENT '版本号',
  `remark` text COMMENT '备注',
  PRIMARY KEY (`id`)
);
```

### 3. 歌曲表 (songs)

```sql
CREATE TABLE `songs` (
  `id` varchar(255) NOT NULL COMMENT '加密ID',
  `album_id` varchar(255) COMMENT '所属专辑ID',
  `song_title` varchar(200) NOT NULL COMMENT '歌曲标题',
  `track_number` int COMMENT '曲目编号',
  `duration` varchar(20) COMMENT '歌曲时长',
  `lyricist` varchar(200) COMMENT '作词',
  `composer` varchar(200) COMMENT '作曲',
  `arranger` varchar(200) COMMENT '编曲',
  `singer` varchar(200) COMMENT '演唱',
  `audio_url` varchar(500) COMMENT '音频文件地址',
  `mv_url` varchar(500) COMMENT 'MV视频地址',
  `play_count` bigint DEFAULT 0 COMMENT '播放次数',
  `like_count` int DEFAULT 0 COMMENT '点赞次数',
  `comment_count` int DEFAULT 0 COMMENT '评论次数',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP,
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `creator_id` varchar(255) COMMENT '创建者ID',
  `updater_id` varchar(255) COMMENT '更新者ID',
  `deleted` tinyint(1) DEFAULT 0 COMMENT '逻辑删除标志',
  `version` int DEFAULT 0 COMMENT '版本号',
  `remark` text COMMENT '备注',
  PRIMARY KEY (`id`)
);
```

### 4. 系统日志表 (system_logs)

```sql
CREATE TABLE `system_logs` (
  `id` varchar(255) NOT NULL COMMENT '加密ID',
  `user_id` varchar(255) COMMENT '操作用户ID',
  `action` varchar(100) NOT NULL COMMENT '操作类型',
  `module` varchar(50) NOT NULL COMMENT '操作模块',
  `description` text COMMENT '操作描述',
  `ip_address` varchar(255) COMMENT '操作IP地址(加密)',
  `request_params` json COMMENT '请求参数',
  `response_result` json COMMENT '响应结果',
  `status` tinyint(1) COMMENT '操作状态(0:失败,1:成功)',
  `error_message` text COMMENT '错误信息',
  `execution_time` bigint COMMENT '执行时间(毫秒)',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
);
```

## 核心功能

### 1. 用户认证与授权
- **登录验证**: 用户名密码验证，支持密码加密存储
- **会话管理**: JWT token 认证机制
- **权限控制**: 基于角色的访问控制

### 2. 音乐作品管理
- **专辑管理**: 创建、编辑、删除、查询专辑信息
- **歌曲管理**: 维护专辑下的歌曲信息
- **批量操作**: 支持批量删除等操作
- **状态管理**: 专辑发布状态控制

### 3. 数据安全
- **ID加密**: 所有数据库ID使用AES加密存储
- **敏感信息加密**: 邮箱、手机号、IP地址等敏感信息加密
- **密码安全**: MD5+盐值加密存储用户密码

## 项目结构

### 后端结构
```
backend/src/main/java/com/lay/music/
├── common/                    # 通用模块
│   ├── entity/               # 基础实体类
│   │   └── BaseEntity.java
│   ├── utils/                # 工具类
│   │   └── EncryptUtil.java
│   └── result/               # 响应结果类
│       └── Result.java
├── admin/                    # 管理模块
│   ├── entity/               # 实体类
│   │   ├── AdminUser.java
│   │   ├── MusicAlbum.java
│   │   ├── Song.java
│   │   └── SystemLog.java
│   ├── service/              # 服务接口
│   │   ├── AdminAuthService.java
│   │   └── MusicAlbumService.java
│   └── controller/           # 控制器
│       ├── AdminAuthController.java
│       └── MusicAlbumController.java
```

### 前端结构
```
src/
├── views/                    # 页面组件
│   ├── AdminLogin.vue       # 登录页面
│   └── AdminDashboard.vue   # 管理主页
├── api/                     # API接口
│   └── admin.js
└── router/                  # 路由配置
    └── index.js
```

## API接口文档

### 认证相关接口

#### 1. 管理员登录
```
POST /api/admin/auth/login
```

**请求参数:**
```json
{
  "username": "admin",
  "password": "admin123"
}
```

**响应数据:**
```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "encryptedId": "LM_admin_001",
    "username": "admin",
    "realName": "系统管理员",
    "email": "admin@laymusic.com",
    "token": "jwt_token_string"
  },
  "timestamp": 1640995200000
}
```

#### 2. 管理员登出
```
POST /api/admin/auth/logout
Headers: Authorization: Bearer {token}
```

### 专辑管理接口

#### 1. 获取专辑列表
```
GET /api/admin/album/list?page=1&size=10&keyword=搜索关键词
Headers: Authorization: Bearer {token}
```

#### 2. 创建专辑
```
POST /api/admin/album/create
Headers: Authorization: Bearer {token}
```

**请求参数:**
```json
{
  "albumTitle": "专辑名称",
  "trackCount": 12,
  "totalDuration": "42:30",
  "genre": "流行",
  "releaseYear": 2024,
  "description": "专辑描述",
  "achievements": "{\"award\": \"最佳专辑\"}",
  "neteaseAlbumId": "12345678",
  "backgroundImage": "http://example.com/bg.jpg",
  "coverImage": "http://example.com/cover.jpg"
}
```

#### 3. 更新专辑
```
PUT /api/admin/album/update
Headers: Authorization: Bearer {token}
```

#### 4. 删除专辑
```
DELETE /api/admin/album/delete/{albumId}
Headers: Authorization: Bearer {token}
```

## 安全特性

### 1. 数据加密
- **ID加密**: 使用AES算法加密所有数据库主键
- **敏感字段加密**: 邮箱、手机号、IP地址等使用AES加密
- **密码加密**: MD5+随机盐值加密存储

### 2. 访问控制
- **JWT认证**: 基于JWT的无状态认证
- **路由守卫**: 前端路由级别的权限验证
- **接口权限**: 后端接口级别的权限控制

### 3. 安全配置
```java
// 密钥配置（生产环境应从配置文件读取）
private static final String SECRET_KEY = "LayMusicProject2024SecretKey";
private static final String ALGORITHM = "AES";
private static final String TRANSFORMATION = "AES/ECB/PKCS5Padding";
```

## 部署说明

### 1. 环境要求
- **Java**: JDK 8 或更高版本
- **MySQL**: 5.7 或更高版本
- **Node.js**: 14 或更高版本
- **Maven**: 3.6 或更高版本

### 2. 数据库配置
```properties
# application.properties
spring.datasource.url=jdbc:mysql://localhost:3306/lay_music?useUnicode=true&characterEncoding=utf-8&useSSL=false
spring.datasource.username=root
spring.datasource.password=Hansen1791428864
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
```

### 3. 前端构建
```bash
# 安装依赖
npm install

# 开发环境启动
npm run dev

# 生产环境构建
npm run build
```

### 4. 后端构建
```bash
# Maven 构建
mvn clean package

# 运行 JAR 包
java -jar target/lay-music-admin.jar
```

## 访问说明

### 1. 系统访问地址
- **前端地址**: http://localhost:5173/x-back
- **后端API**: http://localhost:8080/api/admin

### 2. 默认管理员账号
- **用户名**: admin
- **密码**: admin123

### 3. 页面路由
- **登录页面**: `/x-back`
- **管理主页**: `/x-back/dashboard`

## 功能特点

### 1. 用户体验
- **响应式设计**: 支持PC和移动端访问
- **现代化UI**: 简洁美观的管理界面
- **操作友好**: 直观的操作流程和提示信息

### 2. 系统性能
- **分页查询**: 支持大数据量的分页显示
- **异步操作**: 前端异步请求，提升用户体验
- **数据缓存**: 合理的数据缓存机制

### 3. 扩展性
- **模块化设计**: 便于功能模块的扩展
- **接口标准化**: 统一的API接口规范
- **配置化管理**: 灵活的系统配置

## 维护说明

### 1. 日志管理
- 系统操作日志自动记录到 `system_logs` 表
- 包含操作用户、操作类型、执行时间等信息

### 2. 数据备份
- 定期备份 MySQL 数据库
- 建议每日进行增量备份

### 3. 监控告警
- 监控系统运行状态
- 设置异常情况告警机制

## 开发规范

### 1. 代码规范
- 遵循 Java 编码规范
- 使用有意义的变量和方法命名
- 添加必要的注释说明

### 2. 数据库规范
- 使用有意义的表名和字段名
- 添加必要的索引优化查询
- 遵循数据库设计三范式

### 3. 安全规范
- 所有用户输入必须进行验证
- 敏感信息必须加密存储
- 定期更新加密密钥

## 后续优化建议

### 1. 功能扩展
- 添加歌曲管理功能
- 实现用户权限细分
- 增加数据统计报表

### 2. 性能优化
- 实现Redis缓存
- 优化数据库查询
- 前端资源压缩

### 3. 安全增强
- 实现验证码机制
- 添加操作审计功能
- 增强密码策略

---

**项目作者**: Lay Zhang Music Team  
**文档版本**: v1.0  
**更新时间**: 2024年1月  
**联系方式**: admin@laymusic.com 
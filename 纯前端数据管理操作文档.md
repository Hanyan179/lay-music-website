# 宿命回响 - 纯前端数据管理操作文档

## 📁 项目文件结构

### 1. 主要目录结构
```
fate-echoes/
├── public/                          # 静态资源目录
│   ├── images/                      # 图片资源
│   │   ├── covers/                  # 书籍封面图片
│   │   │   ├── test_life.jpg        # 测试人生封面
│   │   │   └── [书籍代码].jpg       # 其他书籍封面
│   │   ├── events/                  # 时间线事件图片
│   │   │   ├── birth_1995.jpg       # 1995年出生
│   │   │   ├── youth_2010.jpg       # 2010年青春
│   │   │   └── summary_2020.jpg     # 2020年总结
│   │   ├── choices/                 # 选择场景图片
│   │   │   ├── family_start.jpg     # 家庭环境选择
│   │   │   ├── teenager_choice.jpg  # 青少年选择
│   │   │   └── career_choice.jpg    # 职业选择
│   │   ├── effects/                 # 选择影响图片
│   │   │   ├── warm_family.jpg      # 温馨家庭影响
│   │   │   ├── strict_education.jpg # 严格教育影响
│   │   │   ├── academic_success.jpg # 学术成就影响
│   │   │   ├── artistic_talent.jpg  # 艺术天赋影响
│   │   │   ├── social_skills.jpg    # 社交能力影响
│   │   │   ├── teacher_life.jpg     # 教师生活影响
│   │   │   └── business_success.jpg # 创业成功影响
│   │   └── backgrounds/             # 背景图片
│   │       ├── books-pattern.jpg    # 书籍页面背景
│   │       ├── game-pattern.jpg     # 游戏页面背景
│   │       └── choice-pattern.jpg   # 选择页面背景
│   └── favicon.ico                  # 网站图标
├── src/                             # 源代码目录
│   ├── assets/                      # 样式资源
│   │   └── main.css                 # 主样式文件（苹果风格）
│   ├── components/                  # 组件目录（可扩展）
│   ├── stores/                      # 数据存储
│   │   └── dataStore.ts             # 主数据存储文件
│   ├── types/                       # 类型定义
│   │   └── index.ts                 # TypeScript 类型定义
│   ├── views/                       # 页面组件
│   │   ├── Home.vue                 # 首页
│   │   ├── Books.vue                # 书籍列表页
│   │   ├── BookDetail.vue           # 书籍详情页
│   │   └── GamePlay.vue             # 游戏页面
│   ├── router/                      # 路由配置
│   │   └── index.ts                 # 路由定义
│   ├── App.vue                      # 主应用组件
│   └── main.ts                      # 应用入口文件
├── package.json                     # 项目依赖配置
├── vite.config.js                   # Vite 构建配置
├── tailwind.config.js               # Tailwind CSS 配置
├── postcss.config.js                # PostCSS 配置
└── README_纯前端版本.md              # 项目说明文档
```

### 2. 数据存储位置
**位置**: `src/stores/dataStore.ts`
**说明**: 所有的书籍、事件、选择数据都存储在 `STATIC_DATA` 对象中

### 3. 用户数据存储
**位置**: 浏览器 LocalStorage
**说明**: 游戏进度、点赞记录等用户数据

## 🎨 苹果风格设计系统

### 1. 设计原则
- **简洁优雅**: 采用苹果风格的极简设计理念
- **视觉层次**: 使用毛玻璃效果和渐变创建深度感
- **流畅动画**: 所有交互都有平滑的过渡效果
- **响应式设计**: 完美适配各种设备尺寸

### 2. 主要样式类
```css
/* 苹果风格按钮 */
.apple-btn-primary          # 主要按钮（蓝色渐变）
.apple-btn-secondary        # 次要按钮（灰色）

/* 苹果风格卡片 */
.apple-card                 # 基础卡片样式
.apple-card-image           # 卡片图片样式

/* 毛玻璃效果 */
.apple-glass               # 浅色毛玻璃
.apple-glass-dark          # 深色毛玻璃

/* 背景图案 */
.bg-books-pattern          # 书籍页面背景
.bg-game-pattern           # 游戏页面背景
.bg-choice-pattern         # 选择页面背景

/* 游戏相关 */
.choice-card               # 选择卡片
.effect-card               # 影响展示卡片
.timeline-carousel         # 时间线轮播图
.year-indicator            # 年份指示器
```

### 3. 颜色系统
```css
/* 主色调 */
--blue-primary: #3B82F6      /* 主蓝色 */
--purple-accent: #8B5CF6     /* 紫色强调 */
--green-success: #10B981     /* 成功绿色 */
--red-error: #EF4444         /* 错误红色 */

/* 背景色 */
--bg-primary: #f5f5f7        /* 主背景色 */
--bg-glass: rgba(255,255,255,0.25)  /* 毛玻璃背景 */
```

## 📊 数据结构说明

### 书籍数据结构 (CharacterBook)
```typescript
interface CharacterBook {
  id: number                 // 唯一标识符
  bookCode: string          // 书籍代码
  title: string             // 书籍标题
  subtitle?: string         // 副标题（可选）
  description: string       // 书籍描述
  author: string           // 作者
  startYear: number        // 开始年份
  endYear: number          // 结束年份
  primaryColor: string     // 主题色（十六进制）
  coverImage?: string      // 封面图片路径（可选）
  playCount: number        // 游玩次数（初始为0）
  likeCount: number        // 点赞数（初始为0）
  isCompleted: boolean     // 是否完成
  isUploaded: boolean      // 是否上传
  userToken?: string       // 用户标识（可选）
  createdAt: string        // 创建时间
  updatedAt: string        // 更新时间
}
```

### 时间线事件数据结构 (TimelineEvent)
```typescript
interface TimelineEvent {
  id: number               // 唯一标识符
  bookId: number          // 所属书籍ID
  year: number            // 发生年份
  title: string           // 事件标题
  description: string     // 事件描述
  mediaType?: 'image' | 'video'  // 媒体类型（可选）
  mediaUrl?: string       // 媒体文件路径（可选）
  mediaPoster?: string    // 视频封面图（可选）
  impact: number          // 影响力（1-5）
  tags: string[]          // 标签数组
  displayOrder: number    // 显示顺序
}
```

### 人生抉择事件数据结构 (PersonalChoiceEvent)
```typescript
interface PersonalChoiceEvent {
  id: number               // 唯一标识符
  bookId: number          // 所属书籍ID
  year: number            // 发生年份
  eventCode: string       // 事件代码（用于跳转）
  question: string        // 问题/标题
  description: string     // 详细描述
  mediaType?: 'image' | 'video'  // 媒体类型（可选）
  mediaUrl?: string       // 媒体文件路径（可选）
  mediaPoster?: string    // 视频封面图（可选）
  isStartingEvent: boolean // 是否为起始事件
  displayOrder: number    // 显示顺序
  afterDescription?: string // 选择后的描述（可选）
  options: ChoiceOption[] // 选择选项数组
}
```

### 选择选项数据结构 (ChoiceOption)
```typescript
interface ChoiceOption {
  id: number               // 唯一标识符
  eventId: number         // 所属事件ID
  optionText: string      // 选项文本
  effect: string          // 选择效果描述
  nextEventCode?: string  // 下一个事件代码（可选）
  isNextYear: boolean     // 是否跳转到下一年
  actionType: 'CONTINUE' | 'END' | 'NEXT_EVENT'  // 动作类型
  tags: string[]          // 标签数组
  sortOrder: number       // 排序顺序
  mediaUrl?: string       // 媒体文件路径（可选）
  mediaType?: 'image' | 'video'  // 媒体类型（可选）
}
```

## 🛠️ 图片资源管理

### 1. 图片命名规范
```
封面图片: [书籍代码].jpg
事件图片: [事件描述]_[年份].jpg
选择图片: [选择类型]_choice.jpg
影响图片: [影响类型].jpg
背景图片: [页面类型]-pattern.jpg
```

### 2. 图片尺寸要求
```
封面图片: 400x600px (推荐比例 2:3)
事件图片: 800x450px (推荐比例 16:9)
选择图片: 1200x675px (推荐比例 16:9)
影响图片: 600x400px (推荐比例 3:2)
背景图片: 1920x1080px (推荐比例 16:9)
```

### 3. 图片路径配置
所有图片路径都以 `/` 开头，相对于 `public` 目录：
```typescript
coverImage: '/images/covers/test_life.jpg'
mediaUrl: '/images/events/birth_1995.jpg'
backgroundImage: '/images/backgrounds/game-pattern.jpg'
```

## 🔄 游戏功能特性

### 1. 年度事件轮播图
- **位置**: 游戏页面顶部
- **功能**: 自动轮播显示当前书籍的时间线事件
- **样式**: 苹果风格卡片设计，4秒自动切换

### 2. 选择影响展示
- **触发**: 用户确认选择后
- **展示**: 模态框显示选择影响图片和文字描述
- **交互**: 点击"继续"或"下一年"按钮

### 3. 错误回滚机制
- **检测**: 自动检测用户的错误选择
- **标记**: 错误选择将被标记为不可再次点击
- **回滚**: 允许用户重新选择正确答案

### 4. 游戏进度管理
- **保存**: 实时保存到 LocalStorage
- **恢复**: 页面刷新后自动恢复进度
- **重置**: 提供重新开始游戏功能

## 📝 操作步骤

### 1. 添加新书籍

**步骤 1**: 准备图片资源
```bash
# 将封面图片放入对应目录
public/images/covers/新书代码.jpg
```

**步骤 2**: 在 `src/stores/dataStore.ts` 中添加书籍数据
```typescript
{
  id: 2,  // 使用新的ID
  bookCode: 'my_new_book',
  title: '我的新人生',
  subtitle: '另一个选择的故事',
  description: '探索不同的人生道路，体验各种可能性。',
  author: '作者姓名',
  startYear: 1990,
  endYear: 2025,
  primaryColor: '#10B981',  // 绿色主题
  coverImage: '/images/covers/my_new_book.jpg',
  playCount: 0,
  likeCount: 0,
  isCompleted: true,
  isUploaded: true,
  userToken: '',
  createdAt: '2024-01-01T00:00:00',
  updatedAt: '2024-01-01T00:00:00'
}
```

### 2. 添加时间线事件

**步骤 1**: 准备事件图片
```bash
public/images/events/事件描述_年份.jpg
```

**步骤 2**: 添加事件数据
```typescript
{
  id: 4,
  bookId: 2,  // 对应书籍ID
  year: 1990,
  title: '新的开始',
  description: '人生的新篇章开始了',
  mediaType: 'image',
  mediaUrl: '/images/events/new_start_1990.jpg',
  impact: 5,
  tags: ['开始', '重要'],
  displayOrder: 1
}
```

### 3. 添加人生抉择事件

**步骤 1**: 准备相关图片
```bash
public/images/choices/选择场景.jpg    # 选择场景图
public/images/effects/影响效果.jpg    # 选择影响图
```

**步骤 2**: 添加抉择事件
```typescript
{
  id: 5,
  bookId: 2,
  year: 1990,
  eventCode: 'new_start',
  question: '你的新开始',
  description: '1990年，你面临人生的重要选择...',
  mediaType: 'image',
  mediaUrl: '/images/choices/new_start_choice.jpg',
  isStartingEvent: true,
  displayOrder: 1,
  afterDescription: '你的选择将影响整个人生轨迹...',
  options: [
    {
      id: 8,
      eventId: 5,
      optionText: '勇敢前进',
      effect: '获得勇气+3，开启冒险人生',
      nextEventCode: 'next_choice',
      isNextYear: true,
      actionType: 'NEXT_EVENT',
      tags: ['勇敢', '冒险'],
      sortOrder: 1,
      mediaUrl: '/images/effects/brave_forward.jpg',
      mediaType: 'image'
    }
  ]
}
```

## 🎯 主题色建议

### 苹果风格色彩系统
```typescript
// 主要色彩
'#007AFF'  // 苹果蓝 - 科技、理性
'#34C759'  // 苹果绿 - 自然、成长
'#5856D6'  // 苹果紫 - 创意、神秘
'#FF9500'  // 苹果橙 - 活力、热情
'#FF3B30'  // 苹果红 - 激情、力量
'#8E8E93'  // 苹果灰 - 沉静、内敛

// 渐变组合
'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'  // 蓝紫渐变
'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)'  // 粉红渐变
'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)'  // 蓝青渐变
```

## ⚡ 开发与部署

### 1. 本地开发
```bash
npm run dev          # 启动开发服务器
npm run build        # 构建生产版本
npm run preview      # 预览生产版本
```

### 2. 项目配置
- **开发端口**: http://localhost:5173
- **构建工具**: Vite
- **样式系统**: Tailwind CSS + 自定义苹果风格
- **状态管理**: Pinia
- **路由系统**: Vue Router

### 3. 部署要求
- **静态网站托管**: 任何支持静态文件的服务器
- **图片资源**: 确保所有图片文件正确上传
- **浏览器兼容**: 现代浏览器（支持 ES6+）

## 🔧 故障排除

### 1. 图片不显示
- 检查图片路径是否正确（以 `/` 开头）
- 确认图片文件存在于 `public/images/` 目录
- 检查图片文件名大小写是否匹配

### 2. 样式不加载
- 确认 `postcss.config.js` 配置正确
- 检查 `tailwind.config.js` 路径配置
- 重启开发服务器

### 3. 游戏进度丢失
- 检查浏览器 LocalStorage 是否被清除
- 确认 `dataStore.saveGameState()` 正常调用
- 检查浏览器控制台是否有错误

### 4. 路由跳转失败
- 检查路由配置是否正确
- 确认组件文件存在
- 检查事件代码 `eventCode` 是否匹配

通过以上文档，您可以轻松地管理和扩展您的苹果风格纯前端人生选择游戏！ 
# Fate Echoes æ•°æ®åº“è¿ç§»æŒ‡å—

## é—®é¢˜è§£å†³æ–¹æ¡ˆ

æ‚¨çš„é¡¹ç›®æ— æ³•å¯åŠ¨æ˜¯å› ä¸ºï¼š
1. `PersonalChoiceEvent` å®ä½“å¼•ç”¨äº†ä¸å­˜åœ¨çš„ `TimelinePage` ç±»ï¼ˆå·²ä¿®å¤ï¼‰
2. æ•°æ®åº“ç¼ºå°‘å¿…è¦çš„è¡¨ç»“æ„
3. ç°æœ‰çš„ `events` å’Œ `options` è¡¨éœ€è¦é‡æ–°è®¾è®¡

## âœ… å·²å®Œæˆçš„ä¿®å¤

1. **ä¿®å¤äº† PersonalChoiceEvent å®ä½“ç±»**
   - ç§»é™¤äº†å¯¹ä¸å­˜åœ¨çš„ `TimelinePage` çš„å¼•ç”¨
   - ä¿ç•™äº†æ‰€æœ‰å¿…è¦çš„å­—æ®µå’Œå…³ç³»

2. **åˆ›å»ºäº†å®Œæ•´çš„æ•°æ®åº“ç»“æ„**
   - `personal_choice_events` - äººç”ŸæŠ‰æ‹©äº‹ä»¶è¡¨
   - `choice_options` - é€‰æ‹©é€‰é¡¹è¡¨  
   - `timeline_events` - å¹´åº¦äº‹ä»¶è¡¨ï¼ˆæ›¿ä»£åŸ eventsï¼‰
   - `event_options` - é€šç”¨äº‹ä»¶é€‰é¡¹è¡¨ï¼ˆæ›¿ä»£åŸ optionsï¼‰

3. **åˆ›å»ºäº†å¯¹åº”çš„å®ä½“ç±»å’ŒRepository**
   - `TimelineEvent` å®ä½“ç±»
   - `TimelineEventRepository`
   - `PersonalChoiceEventRepository` 
   - `ChoiceOptionRepository`

## ğŸ”§ æ‰§è¡Œè¿ç§»æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šå¤‡ä»½æ•°æ®åº“
```sql
-- åœ¨æ‰§è¡Œä»»ä½•è¿ç§»å‰ï¼Œè¯·å…ˆå¤‡ä»½æ‚¨çš„æ•°æ®åº“ï¼
mysqldump -u [ç”¨æˆ·å] -p [æ•°æ®åº“å] > backup_$(date +%Y%m%d_%H%M%S).sql
```

### ç¬¬äºŒæ­¥ï¼šæ‰§è¡Œæ•°æ®åº“è¿ç§»

#### æ–¹æ³•1ï¼šä½¿ç”¨MySQLå‘½ä»¤è¡Œ
```bash
mysql -u [ç”¨æˆ·å] -p [æ•°æ®åº“å] < src/main/resources/sql/migrate_existing_database.sql
```

#### æ–¹æ³•2ï¼šåœ¨MySQLå®¢æˆ·ç«¯ä¸­æ‰§è¡Œ
```sql
-- ç™»å½•MySQLåæ‰§è¡Œ
source src/main/resources/sql/migrate_existing_database.sql;
```

#### æ–¹æ³•3ï¼šåœ¨æ•°æ®åº“ç®¡ç†å·¥å…·ä¸­æ‰§è¡Œ
ç›´æ¥æ‰“å¼€ `src/main/resources/sql/migrate_existing_database.sql` æ–‡ä»¶ï¼Œå¤åˆ¶å†…å®¹åˆ°æ‚¨çš„æ•°æ®åº“ç®¡ç†å·¥å…·ï¼ˆå¦‚Navicatã€phpMyAdminç­‰ï¼‰ä¸­æ‰§è¡Œã€‚

### ç¬¬ä¸‰æ­¥ï¼šéªŒè¯è¿ç§»ç»“æœ

æ‰§è¡Œä»¥ä¸‹SQLæŸ¥è¯¢éªŒè¯è¡¨ç»“æ„ï¼š
```sql
-- æŸ¥çœ‹æ‰€æœ‰è¡¨
SHOW TABLES;

-- æŸ¥çœ‹è¡¨ç»“æ„
DESCRIBE character_books;
DESCRIBE personal_choice_events;
DESCRIBE choice_options;
DESCRIBE timeline_events;
DESCRIBE event_options;

-- æŸ¥çœ‹æµ‹è¯•æ•°æ®
SELECT * FROM character_books WHERE book_code = 'test_life';
SELECT * FROM personal_choice_events;
SELECT * FROM choice_options;
```

### ç¬¬å››æ­¥ï¼šå¯åŠ¨åº”ç”¨æµ‹è¯•

```bash
# ä½¿ç”¨Mavenå¯åŠ¨
mvn spring-boot:run

# æˆ–ä½¿ç”¨Gradleå¯åŠ¨
./gradlew bootRun
```

## ğŸ“‹ è¿ç§»è„šæœ¬åŠŸèƒ½è¯´æ˜

### `migrate_existing_database.sql` è„šæœ¬åŠŸèƒ½ï¼š

1. **æ™ºèƒ½æ£€æµ‹å’Œæ›´æ–°**
   - æ£€æŸ¥ `character_books` è¡¨æ˜¯å¦ç¼ºå°‘æ–°å­—æ®µï¼ˆ`is_uploaded`, `is_completed`, `user_token`ï¼‰
   - å¦‚æœç¼ºå°‘åˆ™è‡ªåŠ¨æ·»åŠ 
   - æ·»åŠ å¿…è¦çš„ç´¢å¼•

2. **è¡¨é‡å‘½åå’Œå¤‡ä»½**
   - å°†ç°æœ‰çš„ `events` è¡¨é‡å‘½åä¸º `events_backup`
   - å°†ç°æœ‰çš„ `options` è¡¨é‡å‘½åä¸º `options_backup`
   - åˆ›å»ºæ–°çš„è§„èŒƒåŒ–è¡¨ç»“æ„

3. **åˆ›å»ºæ–°è¡¨**
   - `personal_choice_events` - äººç”ŸæŠ‰æ‹©äº‹ä»¶
   - `choice_options` - é€‰æ‹©é€‰é¡¹
   - `timeline_events` - å¹´åº¦äº‹ä»¶ï¼ˆæ–°ç»“æ„ï¼‰
   - `event_options` - é€šç”¨äº‹ä»¶é€‰é¡¹ï¼ˆæ–°ç»“æ„ï¼‰

4. **æ’å…¥æµ‹è¯•æ•°æ®**
   - åˆ›å»ºæµ‹è¯•ä¹¦ç± "æµ‹è¯•äººç”Ÿ"
   - æ·»åŠ ç¤ºä¾‹äººç”ŸæŠ‰æ‹©äº‹ä»¶
   - æ·»åŠ å¯¹åº”çš„é€‰æ‹©é€‰é¡¹
   - æ·»åŠ å¹´åº¦äº‹ä»¶ç¤ºä¾‹

## ğŸ¯ æµ‹è¯•æ•°æ®è¯´æ˜

è¿ç§»å®Œæˆåï¼Œæ‚¨å°†è·å¾—ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ä¹¦ç± "æµ‹è¯•äººç”Ÿ"ï¼ŒåŒ…å«ï¼š

- **äººç”ŸæŠ‰æ‹©äº‹ä»¶**ï¼š
  - 1995å¹´ï¼šäººç”Ÿçš„èµ·ç‚¹
  - 2000å¹´ï¼šèŒä¸šé€‰æ‹©  
  - 2010å¹´ï¼šå®¶åº­è§„åˆ’

- **å¹´åº¦äº‹ä»¶**ï¼š
  - 1995å¹´ï¼šæµ‹è¯•å¼€å§‹
  - 2000å¹´ï¼šæ–°åƒå¹´
  - 2010å¹´ï¼šè€Œç«‹ä¹‹å¹´
  - 2020å¹´ï¼šä¸æƒ‘ä¹‹å¹´

## ğŸ” å¦‚æœé‡åˆ°é—®é¢˜

1. **å¤–é”®çº¦æŸé”™è¯¯**ï¼šç¡®ä¿å…ˆæ‰§è¡Œå®Œæ•´çš„è¿ç§»è„šæœ¬
2. **ç¼–ç é—®é¢˜**ï¼šç¡®ä¿æ•°æ®åº“ä½¿ç”¨ utf8mb4 å­—ç¬¦é›†
3. **æƒé™é—®é¢˜**ï¼šç¡®ä¿MySQLç”¨æˆ·æœ‰CREATEã€ALTERã€DROPç­‰æƒé™
4. **åº”ç”¨å¯åŠ¨å¤±è´¥**ï¼šæ£€æŸ¥ `application.properties` ä¸­çš„æ•°æ®åº“è¿æ¥é…ç½®

## ğŸ“ ç›¸å…³æ–‡ä»¶

- `src/main/resources/sql/migrate_existing_database.sql` - è¿ç§»è„šæœ¬ï¼ˆæ¨èï¼‰
- `src/main/resources/sql/create_tables.sql` - å…¨æ–°å®‰è£…è„šæœ¬
- `src/main/java/com/hansen/fateEchoes/fate_echoes/entity/` - å®ä½“ç±»
- `src/main/java/com/hansen/fateEchoes/fate_echoes/repository/` - Repositoryæ¥å£

æ‰§è¡Œå®Œæ¯•åï¼Œæ‚¨çš„é¡¹ç›®åº”è¯¥å¯ä»¥æ­£å¸¸å¯åŠ¨ï¼ŒTimelineEditor.vue ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œäº†ï¼ 